âœ… DEV/PROD MODE & DEBUG LOGGING IMPLEMENTED
==============================================

ğŸ¯ WHAT'S NEW:

1. APP_MODE Configuration
   âœ… .env: APP_MODE=development|production
   âœ… Automatic OTP behavior switching
   âœ… Email vs Console logging

2. DEBUG_MODE Configuration
   âœ… .env: DEBUG_MODE=true|false
   âœ… Detailed API request/response logging
   âœ… Masked sensitive data (tokens, passwords, OTP)

3. Smart OTP System
   âœ… Development: Static OTP (123456)
   âœ… Production: Random OTP via SMTP
   âœ… Auto-switches based on APP_MODE

4. Debug Middleware
   âœ… Logs all API requests (method, path, headers, body)
   âœ… Logs all API responses (status, duration, body)
   âœ… Shows authenticated user info
   âœ… Excludes /health endpoint to reduce noise

ğŸ—‚ï¸ FILES MODIFIED/CREATED:

Modified:
- .env - Added APP_MODE and DEBUG_MODE
- src/config/index.ts - Added appMode and debugMode config
- src/services/authService.ts - Uses config.appMode for OTP
- src/server.ts - Added debug middleware

Created:
- src/middleware/debugMiddleware.ts - Debug logging middleware
- DEV-PROD-MODE.md - Complete documentation
- test-debug-mode.http - Testing examples
- DEBUG-LOGGING-SETUP.txt - This file

ğŸ”§ CONFIGURATION:

Development Mode (.env):
```
APP_MODE=development
DEBUG_MODE=true
```

Production Mode (.env):
```
APP_MODE=production
DEBUG_MODE=false
SMTP_HOST=smtp.gmail.com
SMTP_USER=your-email@domain.com
SMTP_PASSWORD=your-app-password
```

ğŸ“Š DEBUG OUTPUT EXAMPLE:

When DEBUG_MODE=true, you'll see:

================================================================================
ğŸ”µ [DEBUG] POST /auth/request-otp
================================================================================
â° Timestamp: 2024-11-24T10:30:00.000Z
ğŸŒ IP: ::1
ğŸ“ Full URL: http://localhost:3000/auth/request-otp

ğŸ“‹ Headers:
  content-type: application/json
  authorization: ******************** (hidden)

ğŸ“¦ Request Body:
{
  "email": "test@example.com"
}

--------------------------------------------------------------------------------
âœ… Response Status: 200
â±ï¸  Duration: 45ms

ğŸ“¤ Response Body:
{
  "success": true
}
================================================================================

ğŸš€ STARTUP LOGS:

================================================================================
ğŸš€ GOALNET BACKEND STARTING
================================================================================
ğŸ“ Mode: DEVELOPMENT
ğŸ› Debug Logging: ENABLED âœ…
ğŸŒ Node Environment: development
ğŸ”Œ Port: 3000
ğŸ—„ï¸  MongoDB: mongodb://localhost:27017/goalnet
ğŸ“§ Email Mode: STATIC OTP (123456)
================================================================================

âš ï¸  DEBUG MODE ACTIVE - All API requests/responses will be logged
   To disable: Set DEBUG_MODE=false in .env

ğŸ’¡ DEVELOPMENT MODE FEATURES:
   - Static OTP: 123456
   - Email logging to console
   - Detailed error messages
   - Hot reload enabled

ğŸ”’ SECURITY FEATURES:

âœ… Sensitive Data Masking:
   - Passwords: Masked in logs
   - OTP: Masked in logs
   - Tokens: Truncated (first 20 chars only)
   - Authorization headers: Hidden

âœ… Production Safety:
   - Debug mode disabled in production
   - Minimal logs for performance
   - No sensitive data exposure

ğŸ§ª TESTING:

1. Start server:
   npm run dev

2. Check startup logs for mode confirmation

3. Test with test-debug-mode.http:
   - Request OTP
   - See detailed logs in console
   - Verify OTP with 123456

4. Check console for debug output

ğŸ“ SWITCHING MODES:

Development â†’ Production:
1. Edit .env:
   APP_MODE=production
   DEBUG_MODE=false
2. Configure SMTP settings
3. Restart server
4. OTP will be sent via email

Production â†’ Development:
1. Edit .env:
   APP_MODE=development
   DEBUG_MODE=true
2. Restart server
3. OTP will be 123456

âš¡ PERFORMANCE:

Debug Mode Impact:
- Adds ~10-30ms per request
- Recommended for development only
- Disable in production for optimal speed

Health Check:
- Excluded from debug logs
- Always fast response
- No debug overhead

ğŸ“ BEST PRACTICES:

âœ… Development:
   - Use DEBUG_MODE=true
   - Check logs for issues
   - Use static OTP (123456)

âœ… Testing:
   - Use APP_MODE=development
   - Test all endpoints with .http files
   - Verify debug logs show expected data

âœ… Pre-Production:
   - Use APP_MODE=production, DEBUG_MODE=true
   - Test real SMTP email
   - Monitor logs closely

âœ… Production:
   - Use APP_MODE=production, DEBUG_MODE=false
   - Minimal logs
   - Monitor errors only

ğŸ“š DOCUMENTATION:

See DEV-PROD-MODE.md for:
- Complete configuration guide
- Feature comparison table
- Troubleshooting steps
- Security best practices

ğŸ¯ QUICK REFERENCE:

| Use Case | APP_MODE | DEBUG_MODE | OTP | Logs |
|----------|----------|------------|-----|------|
| Local Dev | development | true | 123456 | Full |
| Testing | development | false | 123456 | Minimal |
| Pre-Prod | production | true | Email | Full |
| Production | production | false | Email | Minimal |

âœ¨ READY TO USE!

Next Steps:
1. Kill existing server: lsof -ti:3000 | xargs kill -9
2. Start server: npm run dev
3. Check startup logs for mode confirmation
4. Test with test-debug-mode.http
5. See beautiful debug logs in console!
