### GoalNet Extended API Tests - AI Profile, Documents, Goals
### Base URL

@baseUrl = http://localhost:3000
@email = test123@example.com
@otp = 123456
# Replace with actual token after login
@token = YOUR_TOKEN_HERE

###############################################
# SETUP: Login First
###############################################

### Step 1: Request OTP
POST {{baseUrl}}/auth/request-otp
Content-Type: application/json

{
  "email": "{{email}}"
}

### Step 2: Verify OTP (Copy token from response)
POST {{baseUrl}}/auth/verify-otp
Content-Type: application/json

{
  "email": "{{email}}",
  "otp": "{{otp}}"
}

###############################################
# AI PROFILE ENDPOINTS
###############################################

### Get AI Profile
GET {{baseUrl}}/me/ai-profile
Authorization: Bearer {{token}}

### Regenerate AI Profile
POST {{baseUrl}}/me/ai-profile/regenerate
Authorization: Bearer {{token}}

###############################################
# DOCUMENTS ENDPOINTS
###############################################

### Get All Documents
GET {{baseUrl}}/me/documents
Authorization: Bearer {{token}}

### Add Document - PDF
POST {{baseUrl}}/me/documents
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "title": "Pitch Deck Q4 2024",
  "type": "pdf",
  "url": "https://example.com/docs/pitch-deck.pdf",
  "fileSize": 2457600,
  "mimeType": "application/pdf",
  "description": "Latest investor pitch deck"
}

### Add Document - Link
POST {{baseUrl}}/me/documents
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "title": "Product Demo Video",
  "type": "link",
  "url": "https://youtube.com/watch?v=demo123",
  "description": "5-minute product walkthrough"
}

### Add Document - PPT
POST {{baseUrl}}/me/documents
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "title": "Market Analysis 2024",
  "type": "pptx",
  "url": "https://example.com/docs/market-analysis.pptx",
  "fileSize": 3145728,
  "mimeType": "application/vnd.openxmlformats-officedocument.presentationml.presentation"
}

### Delete Document (replace doc_id with actual ID)
DELETE {{baseUrl}}/me/documents/doc_id
Authorization: Bearer {{token}}

###############################################
# GOALS ENDPOINTS
###############################################

### Get All Active Goals
GET {{baseUrl}}/me/goals
Authorization: Bearer {{token}}

### Get All Goals (any status)
GET {{baseUrl}}/me/goals?status=completed
Authorization: Bearer {{token}}

### Create Goal - Fundraising
POST {{baseUrl}}/me/goals
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "title": "Raise Series A Funding",
  "description": "Target: $3M from top-tier VCs",
  "targetDate": "2025-06-30",
  "milestones": [
    {
      "title": "Complete pitch deck",
      "completed": true
    },
    {
      "title": "Schedule 20 investor meetings",
      "completed": false
    },
    {
      "title": "Receive term sheet",
      "completed": false
    }
  ],
  "tags": ["fundraising", "series-a", "priority"]
}

### Create Goal - Product Launch
POST {{baseUrl}}/me/goals
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "title": "Launch MVP to 1000 Users",
  "description": "Beta launch with early adopters",
  "targetDate": "2025-03-31",
  "milestones": [
    {
      "title": "Complete core features",
      "completed": true
    },
    {
      "title": "Set up analytics",
      "completed": true
    },
    {
      "title": "Onboard 1000 beta users",
      "completed": false
    }
  ],
  "tags": ["product", "mvp", "growth"]
}

### Create Goal - Hiring
POST {{baseUrl}}/me/goals
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "title": "Hire Lead Engineer",
  "description": "Find full-stack lead with 5+ years exp",
  "targetDate": "2025-02-15",
  "milestones": [
    {
      "title": "Post job listings",
      "completed": true
    },
    {
      "title": "Screen 50 candidates",
      "completed": false
    },
    {
      "title": "Make offer",
      "completed": false
    }
  ],
  "tags": ["hiring", "engineering", "urgent"]
}

### Update Goal Progress (replace goal_id with actual ID)
PUT {{baseUrl}}/me/goals/goal_id
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "progress": 60,
  "milestones": [
    {
      "title": "Complete pitch deck",
      "completed": true,
      "completedAt": "2024-11-20T10:00:00.000Z"
    },
    {
      "title": "Schedule 20 investor meetings",
      "completed": true,
      "completedAt": "2024-11-24T15:30:00.000Z"
    },
    {
      "title": "Receive term sheet",
      "completed": false
    }
  ]
}

### Update Goal Status to Completed
PUT {{baseUrl}}/me/goals/goal_id
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "status": "completed",
  "progress": 100
}

### Archive Goal (soft delete)
DELETE {{baseUrl}}/me/goals/goal_id?archive=true
Authorization: Bearer {{token}}

### Delete Goal Permanently
DELETE {{baseUrl}}/me/goals/goal_id
Authorization: Bearer {{token}}

###############################################
# COMPLETE USER FLOW TEST
###############################################

### 1. Update Profile First
PUT {{baseUrl}}/me
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "name": "Priya Sharma",
  "role": "founder",
  "primaryGoal": "fundraising",
  "company": "TechVenture AI",
  "website": "https://techventure.ai",
  "location": "Chennai, India",
  "oneLiner": "Building AI-powered analytics for SaaS"
}

### 2. Create Goals
POST {{baseUrl}}/me/goals
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "title": "Raise $2M Seed Round",
  "description": "Target angel investors and micro VCs",
  "targetDate": "2025-04-30",
  "milestones": [
    {"title": "Build investor list", "completed": true},
    {"title": "Send 50 cold emails", "completed": false},
    {"title": "Close 10 meetings", "completed": false}
  ],
  "tags": ["fundraising", "seed", "q1-2025"]
}

### 3. Add Documents
POST {{baseUrl}}/me/documents
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "title": "Investor Pitch Deck",
  "type": "pdf",
  "url": "https://drive.google.com/file/d/abc123/pitch.pdf",
  "description": "Seed round pitch deck"
}

### 4. Get AI Profile
GET {{baseUrl}}/me/ai-profile
Authorization: Bearer {{token}}

### 5. Regenerate AI Profile (after adding goals)
POST {{baseUrl}}/me/ai-profile/regenerate
Authorization: Bearer {{token}}

###############################################
# ERROR CASES
###############################################

### Invalid Goal Status
PUT {{baseUrl}}/me/goals/goal_id
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "status": "invalid_status"
}

### Invalid Progress (>100)
PUT {{baseUrl}}/me/goals/goal_id
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "progress": 150
}

### Invalid Document Type
POST {{baseUrl}}/me/documents
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "title": "Test Doc",
  "type": "invalid_type",
  "url": "https://example.com/doc.txt"
}

### Missing Required Fields
POST {{baseUrl}}/me/goals
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "description": "Missing title field"
}

###############################################
# NOTES
###############################################

# Remember to:
# 1. Login first (steps 1-2) and copy the token
# 2. Replace {{token}} with actual JWT token
# 3. Replace goal_id and doc_id with actual IDs from responses
# 4. AI Profile auto-generates based on user profile and goals
# 5. Use ?archive=true to archive goals instead of deleting
